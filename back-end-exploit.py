import requests
import sys


#proxies = {'http':'http://localhost:8080'}
try:
    def create_user(email,password):
        
        headers = {"Content-Type": "application/json"}
        data = '{"email":"%s","password":"%s"}'  %(email,password)
        re = requests.post('http://10.10.11.161/api/v1/user/signup',data=data, headers=headers)
        username = sys.argv[1]           
        if re.status_code == 201:
            
                login(username,password)
        elif re.status_code == 400: 
            login(username,password)
        else:
            print("\nSomething Wrong!!!!")
        
    def login(username,password):
        
        data = f"username={username}&password={password}"
        headers = {"Content-Type":"application/x-www-form-urlencoded"}
        re = requests.post('http://10.10.11.161/api/v1/user/login', data=data, headers=headers)
        var = re.text.split('"')[3]
        print("\nAuthorization: bearer ",var)
        


    if len(sys.argv) == 2:
        print("usage: python3 exploit.py {{email}} {{password}}")
        sys.exit()
    else:
        email = sys.argv[1]
        password = sys.argv[2]
        useranme = sys.argv[1] 
 
    def banner():
        
      var = """ _______________
            < Hello, world! >
            ---------------
                    \   ^__^
                    \  (oo)\_______
                        (__)\       )\/\
                            ||----w |
                            ||     ||""" 
                            
      print(var)      
    if __name__== "__main__":
        banner()
        create_user(email,password)
        
except :
    pass
    
